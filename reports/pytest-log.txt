2025-03-26 15:58:32 - INFO - config.docusign_config - ✓ Configuración de DocuSign validada correctamente
2025-03-26 15:58:32 - DEBUG - config.docusign_config -   - Integration Key: c9b495d2...
2025-03-26 15:58:32 - DEBUG - config.docusign_config -   - Redirect URI: http://localhost:5000/api/docusign/callback
2025-03-26 15:58:32 - INFO - main - Usando base de datos de testing: C:\Users\pepec\Projects\Split_Sheet\tests\test.db
2025-03-26 15:58:32 - INFO - main - Modelos registrados: ['User', 'Agreement', 'Document']
2025-03-26 15:58:32 - INFO - main - Tablas creadas: ['user', 'participants', 'agreement', 'document']
2025-03-26 15:58:32 - INFO - main - Base de datos de testing inicializada
2025-03-26 15:58:32 - INFO - main - Test 'test_generate_pdf' iniciando con: {'app_contexts': 1, 'request_contexts': 0, 'base_app': <Flask 'main'>}
2025-03-26 15:58:32 - INFO - main - Estado inicial de sesión: {'is_active': True, 'in_transaction': True, 'has_changes': False}
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado inicial SQLAlchemy: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - ERROR - main - Error en cleanup: 'scoped_session' object has no attribute 'transaction'
2025-03-26 15:58:32 - DEBUG - main - Usuario creado: pdf_test_20250326195832_771
2025-03-26 15:58:32 - DEBUG - main - Token registrado: eyJ0eXAiOi...
2025-03-26 15:58:32 - DEBUG - main - Estado pre-cleanup: {'is_active': True, 'in_transaction': True, 'transaction_parent': False, 'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0}
2025-03-26 15:58:32 - DEBUG - main - Limpieza radical completada
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado final SQLAlchemy: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - WARNING - main - Detectada transacción activa, intentando limpiar...
2025-03-26 15:58:32 - DEBUG - main - Estado pre-cleanup: {'is_active': True, 'in_transaction': True, 'transaction_parent': False, 'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0}
2025-03-26 15:58:32 - DEBUG - main - Limpieza radical completada
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado post-limpieza: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado final de sesión: {'is_active': True, 'in_transaction': True, 'has_changes': False}
2025-03-26 15:58:32 - WARNING - main - Sesión activa o con cambios detectada, limpiando...
2025-03-26 15:58:32 - INFO - main - Test 'test_generate_pdf_invalid_data' iniciando con: {'app_contexts': 1, 'request_contexts': 0, 'base_app': <Flask 'main'>}
2025-03-26 15:58:32 - INFO - main - Estado inicial de sesión: {'is_active': True, 'in_transaction': True, 'has_changes': False}
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado inicial SQLAlchemy: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - ERROR - main - Error en cleanup: 'scoped_session' object has no attribute 'transaction'
2025-03-26 15:58:32 - INFO - main - Usuario creado: pdf_invalid_20250326195832_555 (len=30)
2025-03-26 15:58:32 - DEBUG - main - Token registrado: eyJ0eXAiOi...
2025-03-26 15:58:32 - DEBUG - main - Estado pre-cleanup: {'is_active': True, 'in_transaction': True, 'transaction_parent': False, 'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0}
2025-03-26 15:58:32 - DEBUG - main - Limpieza radical completada
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado final SQLAlchemy: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - WARNING - main - Detectada transacción activa, intentando limpiar...
2025-03-26 15:58:32 - DEBUG - main - Estado pre-cleanup: {'is_active': True, 'in_transaction': True, 'transaction_parent': False, 'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0}
2025-03-26 15:58:32 - DEBUG - main - Limpieza radical completada
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado post-limpieza: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado final de sesión: {'is_active': True, 'in_transaction': True, 'has_changes': False}
2025-03-26 15:58:32 - WARNING - main - Sesión activa o con cambios detectada, limpiando...
2025-03-26 15:58:32 - INFO - main - Test 'test_generate_pdf_unauthorized' iniciando con: {'app_contexts': 1, 'request_contexts': 0, 'base_app': <Flask 'main'>}
2025-03-26 15:58:32 - INFO - main - Estado inicial de sesión: {'is_active': True, 'in_transaction': True, 'has_changes': False}
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado inicial SQLAlchemy: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado final SQLAlchemy: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - WARNING - main - Detectada transacción activa, intentando limpiar...
2025-03-26 15:58:32 - DEBUG - main - Estado pre-cleanup: {'is_active': True, 'in_transaction': True, 'transaction_parent': False, 'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0}
2025-03-26 15:58:32 - DEBUG - main - Limpieza radical completada
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado post-limpieza: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado final de sesión: {'is_active': True, 'in_transaction': True, 'has_changes': False}
2025-03-26 15:58:32 - WARNING - main - Sesión activa o con cambios detectada, limpiando...
2025-03-26 15:58:32 - INFO - main - Test 'test_generate_pdf_invalid_token' iniciando con: {'app_contexts': 1, 'request_contexts': 0, 'base_app': <Flask 'main'>}
2025-03-26 15:58:32 - INFO - main - Estado inicial de sesión: {'is_active': True, 'in_transaction': True, 'has_changes': False}
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado inicial SQLAlchemy: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Test de token inválido completado exitosamente
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado final SQLAlchemy: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - WARNING - main - Detectada transacción activa, intentando limpiar...
2025-03-26 15:58:32 - DEBUG - main - Estado pre-cleanup: {'is_active': True, 'in_transaction': True, 'transaction_parent': False, 'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0}
2025-03-26 15:58:32 - DEBUG - main - Limpieza radical completada
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado post-limpieza: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado final de sesión: {'is_active': True, 'in_transaction': True, 'has_changes': False}
2025-03-26 15:58:32 - WARNING - main - Sesión activa o con cambios detectada, limpiando...
2025-03-26 15:58:32 - INFO - main - Test 'test_generate_pdf_valid_token' iniciando con: {'app_contexts': 1, 'request_contexts': 0, 'base_app': <Flask 'main'>}
2025-03-26 15:58:32 - INFO - main - Estado inicial de sesión: {'is_active': True, 'in_transaction': True, 'has_changes': False}
2025-03-26 15:58:32 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:32 - INFO - main - Estado inicial SQLAlchemy: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:33 - DEBUG - main - Token registrado: eyJ0eXAiOi...
2025-03-26 15:58:33 - INFO - main - Test con token válido completado exitosamente
2025-03-26 15:58:33 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:33 - INFO - main - Estado final SQLAlchemy: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:33 - WARNING - main - Detectada transacción activa, intentando limpiar...
2025-03-26 15:58:33 - DEBUG - main - Estado pre-cleanup: {'is_active': True, 'in_transaction': True, 'transaction_parent': False, 'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0}
2025-03-26 15:58:33 - DEBUG - main - Limpieza radical completada
2025-03-26 15:58:33 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:33 - INFO - main - Estado post-limpieza: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:33 - INFO - main - Estado final de sesión: {'is_active': True, 'in_transaction': True, 'has_changes': False}
2025-03-26 15:58:33 - WARNING - main - Sesión activa o con cambios detectada, limpiando...
2025-03-26 15:58:33 - INFO - main - Test 'test_pdf_content_structure' iniciando con: {'app_contexts': 1, 'request_contexts': 0, 'base_app': <Flask 'main'>}
2025-03-26 15:58:33 - INFO - main - Estado inicial de sesión: {'is_active': True, 'in_transaction': True, 'has_changes': False}
2025-03-26 15:58:33 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:33 - INFO - main - Estado inicial SQLAlchemy: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:33 - ERROR - main - Error en cleanup: 'scoped_session' object has no attribute 'transaction'
2025-03-26 15:58:33 - DEBUG - main - Usuario creado para test de contenido: pdf_content_20250326195833_178
2025-03-26 15:58:33 - DEBUG - main - Token registrado: eyJ0eXAiOi...
2025-03-26 15:58:33 - DEBUG - main - Estado pre-cleanup: {'is_active': True, 'in_transaction': True, 'transaction_parent': False, 'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0}
2025-03-26 15:58:33 - DEBUG - main - Limpieza radical completada
2025-03-26 15:58:33 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:33 - INFO - main - Estado final SQLAlchemy: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:33 - WARNING - main - Detectada transacción activa, intentando limpiar...
2025-03-26 15:58:33 - DEBUG - main - Estado pre-cleanup: {'is_active': True, 'in_transaction': True, 'transaction_parent': False, 'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0}
2025-03-26 15:58:33 - DEBUG - main - Limpieza radical completada
2025-03-26 15:58:33 - DEBUG - main - Estado de sesión: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:33 - INFO - main - Estado post-limpieza: {'new_objects': 0, 'dirty_objects': 0, 'deleted_objects': 0, 'in_transaction': True, 'is_active': True, 'has_transaction': True}
2025-03-26 15:58:33 - INFO - main - Estado final de sesión: {'is_active': True, 'in_transaction': True, 'has_changes': False}
2025-03-26 15:58:33 - WARNING - main - Sesión activa o con cambios detectada, limpiando...
2025-03-26 15:58:33 - INFO - main - Base de datos de testing limpiada
2025-03-26 15:58:33 - INFO - main - Base de datos de testing limpiada y eliminada
2025-03-26 15:58:33 - INFO - main - Limpiando contexto base
